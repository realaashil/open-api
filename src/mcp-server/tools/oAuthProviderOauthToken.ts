/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import { oAuthProviderOauthToken } from "../../funcs/oAuthProviderOauthToken.js";
import { OAuthTokenRequest$zodSchema } from "../../models/oauthtokenrequest.js";
import { formatResult, ToolDefinition } from "../tools.js";

const args = {
  request: OAuthTokenRequest$zodSchema,
};

export const tool$oAuthProviderOauthToken: ToolDefinition<typeof args> = {
  name: "O-auth-provider-oauth-token",
  description: `Exchange authorization code for tokens

OAuth 2.0 Token Endpoint (RFC 6749 Section 4.1.3).
<br><br>
Exchanges an authorization code, client credentials, or refresh token for access tokens.
<br><br>
<b>Grant Types:</b><br>
- \`authorization_code\`: Exchange auth code for tokens (user-based)<br>
- \`client_credentials\`: Get tokens for machine-to-machine auth<br>
- \`refresh_token\`: Get new access token using refresh token
<br><br>
<b>Client Authentication:</b><br>
Can be provided via:<br>
- HTTP Basic auth: \`Authorization: Basic base64(client_id:client_secret)\`<br>
- Request body: \`client_id\` and \`client_secret\` parameters
<br><br>
<b>PKCE Verification:</b><br>
If authorization used PKCE, the \`code_verifier\` must be provided and will be
verified against the stored code challenge.
`,
  annotations: {
    "title": "",
    "destructiveHint": false,
    "idempotentHint": false,
    "openWorldHint": false,
    "readOnlyHint": false,
  },
  args,
  tool: async (client, args, ctx) => {
    const [result] = await oAuthProviderOauthToken(
      client,
      args.request,
      { fetchOptions: { signal: ctx.signal } },
    ).$inspect();

    if (!result.ok) {
      return {
        content: [{ type: "text", text: result.error.message }],
        isError: true,
      };
    }

    return formatResult(result.value);
  },
};
