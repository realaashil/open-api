/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import { oAuthExchangeOAuthCode } from "../../funcs/oAuthExchangeOAuthCode.js";
import { OAuthExchangeRequest$zodSchema } from "../../models/oauthexchangerequest.js";
import { formatResult, ToolDefinition } from "../tools.js";

const args = {
  request: OAuthExchangeRequest$zodSchema,
};

export const tool$oAuthExchangeOAuthCode: ToolDefinition<typeof args> = {
  name: "O-auth-exchange-O-auth-code",
  description: `Exchange OAuth authorization code for tokens

Exchange an OAuth authorization code for access and ID tokens.
Used after the OAuth authorization flow redirects back to the application.
<br><br>
<b>Supported Providers:</b><br>
- Generic OAuth 2.0 providers configured in org settings
<br><br>
<b>Flow:</b><br>
1. User is redirected to OAuth provider's authorization URL<br>
2. User authorizes and is redirected back with a code<br>
3. This endpoint exchanges the code for tokens<br>
4. Tokens can then be used with the <code>/userAccount/authenticate</code> endpoint
`,
  annotations: {
    "title": "",
    "destructiveHint": false,
    "idempotentHint": false,
    "openWorldHint": false,
    "readOnlyHint": false,
  },
  args,
  tool: async (client, args, ctx) => {
    const [result] = await oAuthExchangeOAuthCode(
      client,
      args.request,
      { fetchOptions: { signal: ctx.signal } },
    ).$inspect();

    if (!result.ok) {
      return {
        content: [{ type: "text", text: result.error.message }],
        isError: true,
      };
    }

    return formatResult(result.value);
  },
};
