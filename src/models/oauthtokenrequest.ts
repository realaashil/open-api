/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod";
import { ClosedEnum } from "../types/enums.js";

/**
 * OAuth grant type:
 *
 * @remarks
 * - `authorization_code`: Exchange auth code for tokens
 * - `client_credentials`: Machine-to-machine auth
 * - `refresh_token`: Get new access token using refresh token
 */
export const GrantType = {
  AuthorizationCode: "authorization_code",
  ClientCredentials: "client_credentials",
  RefreshToken: "refresh_token",
} as const;
/**
 * OAuth grant type:
 *
 * @remarks
 * - `authorization_code`: Exchange auth code for tokens
 * - `client_credentials`: Machine-to-machine auth
 * - `refresh_token`: Get new access token using refresh token
 */
export type GrantType = ClosedEnum<typeof GrantType>;

export const GrantType$zodSchema = z.enum([
  "authorization_code",
  "client_credentials",
  "refresh_token",
]).describe(
  "OAuth grant type:\n- `authorization_code`: Exchange auth code for tokens\n- `client_credentials`: Machine-to-machine auth\n- `refresh_token`: Get new access token using refresh token\n",
);

/**
 * OAuth 2.0 Token Request (RFC 6749 Section 4.1.3).
 *
 * @remarks
 * Request body for exchanging authorization code or credentials for tokens.
 */
export type OAuthTokenRequest = {
  grant_type: GrantType;
  code?: string | undefined;
  redirect_uri?: string | undefined;
  client_id?: string | undefined;
  client_secret?: string | undefined;
  refresh_token?: string | undefined;
  scope?: string | undefined;
  code_verifier?: string | undefined;
};

export const OAuthTokenRequest$zodSchema: z.ZodType<OAuthTokenRequest> = z
  .object({
    client_id: z.string().optional(),
    client_secret: z.string().optional(),
    code: z.string().optional(),
    code_verifier: z.string().optional(),
    grant_type: GrantType$zodSchema,
    redirect_uri: z.string().optional(),
    refresh_token: z.string().optional(),
    scope: z.string().optional(),
  }).describe(
    "OAuth 2.0 Token Request (RFC 6749 Section 4.1.3).\nRequest body for exchanging authorization code or credentials for tokens.\n",
  );
