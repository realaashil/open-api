/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod";
import { stringToBase64 } from "../lib/base64.js";
import { SDKOptions } from "../lib/config.js";
import { HTTPClient } from "../lib/http.js";
import { OAuth2Session, OAuth2SessionStore } from "../lib/oauth2-sessions.js";
import { parse } from "../lib/schemas.js";
import { AddAgentMessageSecurity$zodSchema } from "../models/addagentmessageop.js";
import { AddAIModelProviderSecurity$zodSchema } from "../models/addaimodelproviderop.js";
import { ArchiveConversationSecurity$zodSchema } from "../models/archiveconversationop.js";
import { BulkInviteUsersSecurity$zodSchema } from "../models/bulkinviteusersop.js";
import { CreateAgentConversationSecurity$zodSchema } from "../models/createagentconversationop.js";
import { CreateAgentSecurity$zodSchema } from "../models/createagentop.js";
import { CreateConnectorInstanceSecurity$zodSchema } from "../models/createconnectorinstanceop.js";
import { CreateConversationSecurity$zodSchema } from "../models/createconversationop.js";
import { CreateKnowledgeBaseSecurity$zodSchema } from "../models/createknowledgebaseop.js";
import { CreateRootFolderSecurity$zodSchema } from "../models/createrootfolderop.js";
import { CreateSMTPConfigSecurity$zodSchema } from "../models/createsmtpconfigop.js";
import { CreateSubfolderSecurity$zodSchema } from "../models/createsubfolderop.js";
import { CreateTeamSecurity$zodSchema } from "../models/createteamop.js";
import { DeleteAgentConversationSecurity$zodSchema } from "../models/deleteagentconversationop.js";
import { DeleteAgentSecurity$zodSchema } from "../models/deleteagentop.js";
import { DeleteAgentTemplateSecurity$zodSchema } from "../models/deleteagenttemplateop.js";
import { DeleteAllSearchHistorySecurity$zodSchema } from "../models/deleteallsearchhistoryop.js";
import { DeleteConnectorInstanceSecurity$zodSchema } from "../models/deleteconnectorinstanceop.js";
import { DeleteConversationByIdSecurity$zodSchema } from "../models/deleteconversationbyidop.js";
import { DeleteFolderSecurity$zodSchema } from "../models/deletefolderop.js";
import { DeleteKnowledgeBaseSecurity$zodSchema } from "../models/deleteknowledgebaseop.js";
import { DeleteOrganizationLogoSecurity$zodSchema } from "../models/deleteorganizationlogoop.js";
import { DeleteOrganizationSecurity$zodSchema } from "../models/deleteorganizationop.js";
import { DeleteRecordSecurity$zodSchema } from "../models/deleterecordop.js";
import { DeleteTeamSecurity$zodSchema } from "../models/deleteteamop.js";
import { DeleteUserSecurity$zodSchema } from "../models/deleteuserop.js";
import { DownloadDocumentSecurity$zodSchema } from "../models/downloaddocumentop.js";
import { GetAgentConversationSecurity$zodSchema } from "../models/getagentconversationop.js";
import { GetAgentSecurity$zodSchema } from "../models/getagentop.js";
import { GetAgentPermissionsSecurity$zodSchema } from "../models/getagentpermissionsop.js";
import { GetAgentTemplateSecurity$zodSchema } from "../models/getagenttemplateop.js";
import { GetAllConversationsSecurity$zodSchema } from "../models/getallconversationsop.js";
import { GetAllRecordsSecurity$zodSchema } from "../models/getallrecordsop.js";
import { GetAllUsersSecurity$zodSchema } from "../models/getallusersop.js";
import { GetArchivedConversationsSecurity$zodSchema } from "../models/getarchivedconversationsop.js";
import { GetAvailableFeatureFlagsSecurity$zodSchema } from "../models/getavailablefeatureflagsop.js";
import { GetAvailableModelsByTypeSecurity$zodSchema } from "../models/getavailablemodelsbytypeop.js";
import { GetAzureAdAuthConfigSecurity$zodSchema } from "../models/getazureadauthconfigop.js";
import { GetConnectorConfigSecurity$zodSchema } from "../models/getconnectorconfigop.js";
import { GetConnectorFiltersSecurity$zodSchema } from "../models/getconnectorfiltersop.js";
import { GetConnectorInstanceSecurity$zodSchema } from "../models/getconnectorinstanceop.js";
import { GetConnectorPublicUrlSecurity$zodSchema } from "../models/getconnectorpublicurlop.js";
import { GetConnectorRegistrySecurity$zodSchema } from "../models/getconnectorregistryop.js";
import { GetConnectorSchemaSecurity$zodSchema } from "../models/getconnectorschemaop.js";
import { GetConnectorStatsSecurity$zodSchema } from "../models/getconnectorstatsop.js";
import { GetConversationByIdSecurity$zodSchema } from "../models/getconversationbyidop.js";
import { GetCrawlingJobStatusSecurity$zodSchema } from "../models/getcrawlingjobstatusop.js";
import { GetCurrentOrganizationSecurity$zodSchema } from "../models/getcurrentorganizationop.js";
import { GetCustomSystemPromptSecurity$zodSchema } from "../models/getcustomsystempromptop.js";
import { GetFilterFieldOptionsSecurity$zodSchema } from "../models/getfilterfieldoptionsop.js";
import { GetFolderChildrenSecurity$zodSchema } from "../models/getfolderchildrenop.js";
import { GetFolderContentsSecurity$zodSchema } from "../models/getfoldercontentsop.js";
import { GetFrontendPublicUrlSecurity$zodSchema } from "../models/getfrontendpublicurlop.js";
import { GetGenericOAuthConfigSecurity$zodSchema } from "../models/getgenericoauthconfigop.js";
import { GetGoogleAuthConfigSecurity$zodSchema } from "../models/getgoogleauthconfigop.js";
import { GetKBChildrenSecurity$zodSchema } from "../models/getkbchildrenop.js";
import { GetKBRecordsSecurity$zodSchema } from "../models/getkbrecordsop.js";
import { GetKnowledgeBaseSecurity$zodSchema } from "../models/getknowledgebaseop.js";
import { GetKnowledgeHubChildNodesSecurity$zodSchema } from "../models/getknowledgehubchildnodesop.js";
import { GetKnowledgeHubRootNodesSecurity$zodSchema } from "../models/getknowledgehubrootnodesop.js";
import { GetMetricsCollectionSecurity$zodSchema } from "../models/getmetricscollectionop.js";
import { GetMicrosoftAuthConfigSecurity$zodSchema } from "../models/getmicrosoftauthconfigop.js";
import { GetModelsByTypeSecurity$zodSchema } from "../models/getmodelsbytypeop.js";
import { GetOAuthAuthorizationUrlSecurity$zodSchema } from "../models/getoauthauthorizationurlop.js";
import { GetOrganizationLogoSecurity$zodSchema } from "../models/getorganizationlogoop.js";
import { GetPlatformSettingsSecurity$zodSchema } from "../models/getplatformsettingsop.js";
import { GetRecordByIdSecurity$zodSchema } from "../models/getrecordbyidop.js";
import { GetSMTPConfigSecurity$zodSchema } from "../models/getsmtpconfigop.js";
import { GetSsoAuthConfigSecurity$zodSchema } from "../models/getssoauthconfigop.js";
import { GetStorageConfigSecurity$zodSchema } from "../models/getstorageconfigop.js";
import { GetTeamByIdSecurity$zodSchema } from "../models/getteambyidop.js";
import { GetUploadLimitsSecurity$zodSchema } from "../models/getuploadlimitsop.js";
import { GetUserByIdSecurity$zodSchema } from "../models/getuserbyidop.js";
import { GetUserTeamsSecurity$zodSchema } from "../models/getuserteamsop.js";
import { ListActiveAgentConnectorsSecurity$zodSchema } from "../models/listactiveagentconnectorsop.js";
import { ListActiveConnectorsSecurity$zodSchema } from "../models/listactiveconnectorsop.js";
import { ListAgentConversationsSecurity$zodSchema } from "../models/listagentconversationsop.js";
import { ListAgentsSecurity$zodSchema } from "../models/listagentsop.js";
import { ListAgentTemplatesSecurity$zodSchema } from "../models/listagenttemplatesop.js";
import { ListAgentToolsSecurity$zodSchema } from "../models/listagenttoolsop.js";
import { ListConfiguredConnectorsSecurity$zodSchema } from "../models/listconfiguredconnectorsop.js";
import { ListConnectorInstancesSecurity$zodSchema } from "../models/listconnectorinstancesop.js";
import { ListInactiveConnectorsSecurity$zodSchema } from "../models/listinactiveconnectorsop.js";
import { ListKBPermissionsSecurity$zodSchema } from "../models/listkbpermissionsop.js";
import { ListKnowledgeBasesSecurity$zodSchema } from "../models/listknowledgebasesop.js";
import { ListTeamsSecurity$zodSchema } from "../models/listteamsop.js";
import { ListUsersGraphSecurity$zodSchema } from "../models/listusersgraphop.js";
import { RegenerateAgentAnswerSecurity$zodSchema } from "../models/regenerateagentanswerop.js";
import { RegenerateAnswerSecurity$zodSchema } from "../models/regenerateanswerop.js";
import { ReindexRecordGroupSecurity$zodSchema } from "../models/reindexrecordgroupop.js";
import { ReindexRecordSecurity$zodSchema } from "../models/reindexrecordop.js";
import { RemoveCrawlingJobSecurity$zodSchema } from "../models/removecrawlingjobop.js";
import { ResyncConnectorSecurity$zodSchema } from "../models/resyncconnectorop.js";
import { ScheduleCrawlingJobSecurity$zodSchema } from "../models/schedulecrawlingjobop.js";
import { SearchHistorySecurity$zodSchema } from "../models/searchhistoryop.js";
import { SearchSecurity$zodSchema } from "../models/searchop.js";
import { SetAzureAdAuthConfigSecurity$zodSchema } from "../models/setazureadauthconfigop.js";
import { SetConnectorPublicUrlSecurity$zodSchema } from "../models/setconnectorpublicurlop.js";
import { SetCustomSystemPromptSecurity$zodSchema } from "../models/setcustomsystempromptop.js";
import { SetDefaultAIModelSecurity$zodSchema } from "../models/setdefaultaimodelop.js";
import { SetFrontendPublicUrlSecurity$zodSchema } from "../models/setfrontendpublicurlop.js";
import { SetGoogleAuthConfigSecurity$zodSchema } from "../models/setgoogleauthconfigop.js";
import { SetMicrosoftAuthConfigSecurity$zodSchema } from "../models/setmicrosoftauthconfigop.js";
import { SetOAuthConfigSecurity$zodSchema } from "../models/setoauthconfigop.js";
import { SetPlatformSettingsSecurity$zodSchema } from "../models/setplatformsettingsop.js";
import { SetSsoAuthConfigSecurity$zodSchema } from "../models/setssoauthconfigop.js";
import { ShareAgentSecurity$zodSchema } from "../models/shareagentop.js";
import { ShareConversationSecurity$zodSchema } from "../models/shareconversationop.js";
import { StreamRecordBufferSecurity$zodSchema } from "../models/streamrecordbufferop.js";
import { ToggleConnectorSecurity$zodSchema } from "../models/toggleconnectorop.js";
import { ToggleMetricsCollectionSecurity$zodSchema } from "../models/togglemetricscollectionop.js";
import { UnarchiveConversationSecurity$zodSchema } from "../models/unarchiveconversationop.js";
import { UpdateAgentSecurity$zodSchema } from "../models/updateagentop.js";
import { UpdateAgentPermissionsSecurity$zodSchema } from "../models/updateagentpermissionsop.js";
import { UpdateAgentTemplateSecurity$zodSchema } from "../models/updateagenttemplateop.js";
import { UpdateAIModelProviderSecurity$zodSchema } from "../models/updateaimodelproviderop.js";
import { UpdateConnectorAuthConfigSecurity$zodSchema } from "../models/updateconnectorauthconfigop.js";
import { UpdateConnectorConfigSecurity$zodSchema } from "../models/updateconnectorconfigop.js";
import { UpdateConnectorFiltersSyncConfigSecurity$zodSchema } from "../models/updateconnectorfilterssyncconfigop.js";
import { UpdateConnectorNameSecurity$zodSchema } from "../models/updateconnectornameop.js";
import { UpdateConversationTitleSecurity$zodSchema } from "../models/updateconversationtitleop.js";
import { UpdateFolderSecurity$zodSchema } from "../models/updatefolderop.js";
import { UpdateKBPermissionsSecurity$zodSchema } from "../models/updatekbpermissionsop.js";
import { UpdateKnowledgeBaseSecurity$zodSchema } from "../models/updateknowledgebaseop.js";
import { UpdateMessageFeedbackSecurity$zodSchema } from "../models/updatemessagefeedbackop.js";
import { UpdateOrganizationSecurity$zodSchema } from "../models/updateorganizationop.js";
import { UpdateTeamSecurity$zodSchema } from "../models/updateteamop.js";
import { UpdateUserSecurity$zodSchema } from "../models/updateuserop.js";
import { UploadOrganizationLogoSecurity$zodSchema } from "../models/uploadorganizationlogoop.js";
import { UploadRecordsToFolderSecurity$zodSchema } from "../models/uploadrecordstofolderop.js";
import { UploadRecordsToKBSecurity$zodSchema } from "../models/uploadrecordstokbop.js";
import {
  AfterErrorContext,
  AfterErrorHook,
  BeforeRequestContext,
  BeforeRequestHook,
  HookContext,
  SDKInitHook,
} from "./types.js";

type Credentials = {
  clientID: string;
  clientSecret: string;
  scopes: string[] | undefined;
  tokenURL: string | undefined;
  additionalProperties: Record<string, string>;
};

const TokenResponseDataSchema = z.object({
  access_token: z.string(),
  token_type: z.string(),
  expires_in: z.number().optional(),
});

export class ClientCredentialsHook
  implements SDKInitHook, BeforeRequestHook, AfterErrorHook
{
  private client?: HTTPClient;
  private sessionStore = new OAuth2SessionStore();
  sdkInit(opts: SDKOptions): SDKOptions {
    this.client = opts.httpClient || new HTTPClient();

    return opts;
  }

  private isHookDisabled(hookCtx: HookContext): boolean {
    return !hookCtx.oAuth2Scopes;
  }

  async beforeRequest(
    hookCtx: BeforeRequestContext,
    request: Request,
  ): Promise<Request> {
    if (this.isHookDisabled(hookCtx)) {
      return request;
    }

    const credentials = await this.getCredentials(hookCtx);
    if (!credentials || Object.values(credentials).some(v => v === "")) {
      return request;
    }

    const sessionKey = this.getSessionKey(credentials);
    const requiredScopes = this.getRequiredScopes(
      credentials,
      hookCtx.oAuth2Scopes!,
    );

    let session = this.sessionStore.getSession(sessionKey, requiredScopes);

    if (!session) {
      session = await this.doTokenRequest(
        hookCtx,
        credentials,
        requiredScopes,
      );

      this.sessionStore.storeSession(sessionKey, requiredScopes, session);
    }

    request.headers.set("Authorization", `Bearer ${session.token}`);

    return request;
  }

  async afterError(
    hookCtx: AfterErrorContext,
    response: Response | null,
    error: unknown,
  ): Promise<{ response: Response | null; error: unknown }> {
    if (this.isHookDisabled(hookCtx)) {
      return { response, error };
    }

    if (error) {
      return { response, error };
    }

    const credentials = await this.getCredentials(hookCtx);
    if (!credentials || Object.values(credentials).some(v => v === "")) {
      return { response, error };
    }

    if (response && response?.status === 401) {
      const sessionKey = this.getSessionKey(credentials);
      const requiredScopes = this.getRequiredScopes(
        credentials,
        hookCtx.oAuth2Scopes!,
      );
      this.sessionStore.deleteSession(sessionKey, requiredScopes);
    }

    return { response, error };
  }

  private async doTokenRequest(
    hookCtx: HookContext,
    credentials: Credentials,
    scopes: string[],
  ): Promise<OAuth2Session> {
    const formData = new URLSearchParams();
    formData.append("grant_type", "client_credentials");

    const headers: Record<string, string> = {
      "Content-Type": "application/x-www-form-urlencoded",
    };

    formData.append("client_id", credentials.clientID);
    formData.append("client_secret", credentials.clientSecret);

    if (scopes.length > 0) {
      formData.append("scope", scopes.join(" "));
    }

    for (
      const [key, value] of Object.entries(credentials.additionalProperties)
    ) {
      formData.append(key, value);
    }

    if (!hookCtx.baseURL?.toString()) {
      throw new Error("Assertion error: Base URL cannot be empty");
    }
    const tokenURL = new URL(credentials.tokenURL ?? "", hookCtx.baseURL);

    const request = new Request(tokenURL, {
      method: "POST",
      headers,
      body: formData,
    });

    const res = await this.client?.request(request);
    if (!res) {
      throw new Error("Failed to fetch token");
    }

    if (res.status < 200 || res.status >= 300) {
      let errorMessage =
        `Received unexpected status code ${res.status} while fetching token`;
      try {
        errorMessage += `: ${await res.text()}`;
      } catch {
        // ignore response body
      }
      throw new Error(errorMessage);
    }

    const rawData = await res.json();
    const tokenResponseData = parse(
      rawData,
      (val) => TokenResponseDataSchema.parse(val),
      "Invalid token response format",
    );

    const session: OAuth2Session = {
      token: tokenResponseData.access_token,
      scopes: scopes,
    };

    if (tokenResponseData.expires_in !== undefined) {
      session.expiresAt = Date.now() + tokenResponseData.expires_in * 1000;
    }

    return session;
  }

  private async getCredentials(
    hookCtx: HookContext,
  ): Promise<Credentials | null> {
    const source = hookCtx.securitySource;

    if (!source) {
      return null;
    }

    let security = source;
    if (typeof source === "function") {
      security = await source();
    }

    switch (hookCtx.operationID) {
      case "getAllUsers":
        return this.getCredentialsGetAllUsers(security);
      case "getUserById":
        return this.getCredentialsGetUserById(security);
      case "updateUser":
        return this.getCredentialsUpdateUser(security);
      case "deleteUser":
        return this.getCredentialsDeleteUser(security);
      case "bulkInviteUsers":
        return this.getCredentialsBulkInviteUsers(security);
      case "listUsersGraph":
        return this.getCredentialsListUsersGraph(security);
      case "createTeam":
        return this.getCredentialsCreateTeam(security);
      case "listTeams":
        return this.getCredentialsListTeams(security);
      case "getTeamById":
        return this.getCredentialsGetTeamById(security);
      case "updateTeam":
        return this.getCredentialsUpdateTeam(security);
      case "deleteTeam":
        return this.getCredentialsDeleteTeam(security);
      case "getUserTeams":
        return this.getCredentialsGetUserTeams(security);
      case "getCurrentOrganization":
        return this.getCredentialsGetCurrentOrganization(security);
      case "updateOrganization":
        return this.getCredentialsUpdateOrganization(security);
      case "deleteOrganization":
        return this.getCredentialsDeleteOrganization(security);
      case "uploadOrganizationLogo":
        return this.getCredentialsUploadOrganizationLogo(security);
      case "getOrganizationLogo":
        return this.getCredentialsGetOrganizationLogo(security);
      case "deleteOrganizationLogo":
        return this.getCredentialsDeleteOrganizationLogo(security);
      case "downloadDocument":
        return this.getCredentialsDownloadDocument(security);
      case "createKnowledgeBase":
        return this.getCredentialsCreateKnowledgeBase(security);
      case "listKnowledgeBases":
        return this.getCredentialsListKnowledgeBases(security);
      case "getKnowledgeBase":
        return this.getCredentialsGetKnowledgeBase(security);
      case "updateKnowledgeBase":
        return this.getCredentialsUpdateKnowledgeBase(security);
      case "deleteKnowledgeBase":
        return this.getCredentialsDeleteKnowledgeBase(security);
      case "getKnowledgeHubRootNodes":
        return this.getCredentialsGetKnowledgeHubRootNodes(security);
      case "getKnowledgeHubChildNodes":
        return this.getCredentialsGetKnowledgeHubChildNodes(security);
      case "getAllRecords":
        return this.getCredentialsGetAllRecords(security);
      case "getKBRecords":
        return this.getCredentialsGetKBRecords(security);
      case "getKBChildren":
        return this.getCredentialsGetKBChildren(security);
      case "getRecordById":
        return this.getCredentialsGetRecordById(security);
      case "deleteRecord":
        return this.getCredentialsDeleteRecord(security);
      case "streamRecordBuffer":
        return this.getCredentialsStreamRecordBuffer(security);
      case "createRootFolder":
        return this.getCredentialsCreateRootFolder(security);
      case "getFolderContents":
        return this.getCredentialsGetFolderContents(security);
      case "updateFolder":
        return this.getCredentialsUpdateFolder(security);
      case "deleteFolder":
        return this.getCredentialsDeleteFolder(security);
      case "getFolderChildren":
        return this.getCredentialsGetFolderChildren(security);
      case "createSubfolder":
        return this.getCredentialsCreateSubfolder(security);
      case "uploadRecordsToKB":
        return this.getCredentialsUploadRecordsToKB(security);
      case "uploadRecordsToFolder":
        return this.getCredentialsUploadRecordsToFolder(security);
      case "getUploadLimits":
        return this.getCredentialsGetUploadLimits(security);
      case "reindexRecord":
        return this.getCredentialsReindexRecord(security);
      case "reindexRecordGroup":
        return this.getCredentialsReindexRecordGroup(security);
      case "resyncConnector":
        return this.getCredentialsResyncConnector(security);
      case "getConnectorStats":
        return this.getCredentialsGetConnectorStats(security);
      case "listKBPermissions":
        return this.getCredentialsListKBPermissions(security);
      case "updateKBPermissions":
        return this.getCredentialsUpdateKBPermissions(security);
      case "createConversation":
        return this.getCredentialsCreateConversation(security);
      case "getAllConversations":
        return this.getCredentialsGetAllConversations(security);
      case "getArchivedConversations":
        return this.getCredentialsGetArchivedConversations(security);
      case "getConversationById":
        return this.getCredentialsGetConversationById(security);
      case "deleteConversationById":
        return this.getCredentialsDeleteConversationById(security);
      case "shareConversation":
        return this.getCredentialsShareConversation(security);
      case "updateConversationTitle":
        return this.getCredentialsUpdateConversationTitle(security);
      case "archiveConversation":
        return this.getCredentialsArchiveConversation(security);
      case "unarchiveConversation":
        return this.getCredentialsUnarchiveConversation(security);
      case "regenerateAnswer":
        return this.getCredentialsRegenerateAnswer(security);
      case "updateMessageFeedback":
        return this.getCredentialsUpdateMessageFeedback(security);
      case "search":
        return this.getCredentialsSearch(security);
      case "searchHistory":
        return this.getCredentialsSearchHistory(security);
      case "deleteAllSearchHistory":
        return this.getCredentialsDeleteAllSearchHistory(security);
      case "listAgentTemplates":
        return this.getCredentialsListAgentTemplates(security);
      case "getAgentTemplate":
        return this.getCredentialsGetAgentTemplate(security);
      case "updateAgentTemplate":
        return this.getCredentialsUpdateAgentTemplate(security);
      case "deleteAgentTemplate":
        return this.getCredentialsDeleteAgentTemplate(security);
      case "listAgents":
        return this.getCredentialsListAgents(security);
      case "createAgent":
        return this.getCredentialsCreateAgent(security);
      case "listAgentTools":
        return this.getCredentialsListAgentTools(security);
      case "getAgent":
        return this.getCredentialsGetAgent(security);
      case "updateAgent":
        return this.getCredentialsUpdateAgent(security);
      case "deleteAgent":
        return this.getCredentialsDeleteAgent(security);
      case "getAgentPermissions":
        return this.getCredentialsGetAgentPermissions(security);
      case "updateAgentPermissions":
        return this.getCredentialsUpdateAgentPermissions(security);
      case "shareAgent":
        return this.getCredentialsShareAgent(security);
      case "listAgentConversations":
        return this.getCredentialsListAgentConversations(security);
      case "createAgentConversation":
        return this.getCredentialsCreateAgentConversation(security);
      case "getAgentConversation":
        return this.getCredentialsGetAgentConversation(security);
      case "deleteAgentConversation":
        return this.getCredentialsDeleteAgentConversation(security);
      case "addAgentMessage":
        return this.getCredentialsAddAgentMessage(security);
      case "regenerateAgentAnswer":
        return this.getCredentialsRegenerateAgentAnswer(security);
      case "getConnectorRegistry":
        return this.getCredentialsGetConnectorRegistry(security);
      case "getConnectorSchema":
        return this.getCredentialsGetConnectorSchema(security);
      case "listConnectorInstances":
        return this.getCredentialsListConnectorInstances(security);
      case "createConnectorInstance":
        return this.getCredentialsCreateConnectorInstance(security);
      case "listActiveConnectors":
        return this.getCredentialsListActiveConnectors(security);
      case "listInactiveConnectors":
        return this.getCredentialsListInactiveConnectors(security);
      case "listConfiguredConnectors":
        return this.getCredentialsListConfiguredConnectors(security);
      case "listActiveAgentConnectors":
        return this.getCredentialsListActiveAgentConnectors(security);
      case "getConnectorInstance":
        return this.getCredentialsGetConnectorInstance(security);
      case "deleteConnectorInstance":
        return this.getCredentialsDeleteConnectorInstance(security);
      case "updateConnectorName":
        return this.getCredentialsUpdateConnectorName(security);
      case "getConnectorConfig":
        return this.getCredentialsGetConnectorConfig(security);
      case "updateConnectorConfig":
        return this.getCredentialsUpdateConnectorConfig(security);
      case "updateConnectorAuthConfig":
        return this.getCredentialsUpdateConnectorAuthConfig(security);
      case "updateConnectorFiltersSyncConfig":
        return this.getCredentialsUpdateConnectorFiltersSyncConfig(security);
      case "toggleConnector":
        return this.getCredentialsToggleConnector(security);
      case "getOAuthAuthorizationUrl":
        return this.getCredentialsGetOAuthAuthorizationUrl(security);
      case "getConnectorFilters":
        return this.getCredentialsGetConnectorFilters(security);
      case "getFilterFieldOptions":
        return this.getCredentialsGetFilterFieldOptions(security);
      case "getStorageConfig":
        return this.getCredentialsGetStorageConfig(security);
      case "createSMTPConfig":
        return this.getCredentialsCreateSMTPConfig(security);
      case "getSMTPConfig":
        return this.getCredentialsGetSMTPConfig(security);
      case "setAzureAdAuthConfig":
        return this.getCredentialsSetAzureAdAuthConfig(security);
      case "getAzureAdAuthConfig":
        return this.getCredentialsGetAzureAdAuthConfig(security);
      case "setMicrosoftAuthConfig":
        return this.getCredentialsSetMicrosoftAuthConfig(security);
      case "getMicrosoftAuthConfig":
        return this.getCredentialsGetMicrosoftAuthConfig(security);
      case "setGoogleAuthConfig":
        return this.getCredentialsSetGoogleAuthConfig(security);
      case "getGoogleAuthConfig":
        return this.getCredentialsGetGoogleAuthConfig(security);
      case "setSsoAuthConfig":
        return this.getCredentialsSetSsoAuthConfig(security);
      case "getSsoAuthConfig":
        return this.getCredentialsGetSsoAuthConfig(security);
      case "setOAuthConfig":
        return this.getCredentialsSetOAuthConfig(security);
      case "getGenericOAuthConfig":
        return this.getCredentialsGetGenericOAuthConfig(security);
      case "getModelsByType":
        return this.getCredentialsGetModelsByType(security);
      case "getAvailableModelsByType":
        return this.getCredentialsGetAvailableModelsByType(security);
      case "addAIModelProvider":
        return this.getCredentialsAddAIModelProvider(security);
      case "updateAIModelProvider":
        return this.getCredentialsUpdateAIModelProvider(security);
      case "setDefaultAIModel":
        return this.getCredentialsSetDefaultAIModel(security);
      case "setFrontendPublicUrl":
        return this.getCredentialsSetFrontendPublicUrl(security);
      case "getFrontendPublicUrl":
        return this.getCredentialsGetFrontendPublicUrl(security);
      case "setConnectorPublicUrl":
        return this.getCredentialsSetConnectorPublicUrl(security);
      case "getConnectorPublicUrl":
        return this.getCredentialsGetConnectorPublicUrl(security);
      case "setPlatformSettings":
        return this.getCredentialsSetPlatformSettings(security);
      case "getPlatformSettings":
        return this.getCredentialsGetPlatformSettings(security);
      case "getAvailableFeatureFlags":
        return this.getCredentialsGetAvailableFeatureFlags(security);
      case "setCustomSystemPrompt":
        return this.getCredentialsSetCustomSystemPrompt(security);
      case "getCustomSystemPrompt":
        return this.getCredentialsGetCustomSystemPrompt(security);
      case "getMetricsCollection":
        return this.getCredentialsGetMetricsCollection(security);
      case "toggleMetricsCollection":
        return this.getCredentialsToggleMetricsCollection(security);
      case "scheduleCrawlingJob":
        return this.getCredentialsScheduleCrawlingJob(security);
      case "getCrawlingJobStatus":
        return this.getCredentialsGetCrawlingJobStatus(security);
      case "removeCrawlingJob":
        return this.getCredentialsRemoveCrawlingJob(security);
    }
    return null;
  }

  private async getCredentialsGetAllUsers(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetAllUsersSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetUserById(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetUserByIdSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUpdateUser(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UpdateUserSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsDeleteUser(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => DeleteUserSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsBulkInviteUsers(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => BulkInviteUsersSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsListUsersGraph(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ListUsersGraphSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsCreateTeam(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => CreateTeamSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsListTeams(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ListTeamsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetTeamById(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetTeamByIdSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUpdateTeam(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UpdateTeamSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsDeleteTeam(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => DeleteTeamSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetUserTeams(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetUserTeamsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetCurrentOrganization(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetCurrentOrganizationSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUpdateOrganization(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UpdateOrganizationSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsDeleteOrganization(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => DeleteOrganizationSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUploadOrganizationLogo(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UploadOrganizationLogoSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetOrganizationLogo(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetOrganizationLogoSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsDeleteOrganizationLogo(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => DeleteOrganizationLogoSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsDownloadDocument(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => DownloadDocumentSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsCreateKnowledgeBase(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => CreateKnowledgeBaseSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsListKnowledgeBases(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ListKnowledgeBasesSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetKnowledgeBase(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetKnowledgeBaseSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUpdateKnowledgeBase(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UpdateKnowledgeBaseSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsDeleteKnowledgeBase(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => DeleteKnowledgeBaseSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetKnowledgeHubRootNodes(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetKnowledgeHubRootNodesSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetKnowledgeHubChildNodes(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetKnowledgeHubChildNodesSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetAllRecords(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetAllRecordsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetKBRecords(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetKBRecordsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetKBChildren(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetKBChildrenSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetRecordById(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetRecordByIdSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsDeleteRecord(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => DeleteRecordSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsStreamRecordBuffer(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => StreamRecordBufferSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsCreateRootFolder(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => CreateRootFolderSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetFolderContents(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetFolderContentsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUpdateFolder(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UpdateFolderSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsDeleteFolder(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => DeleteFolderSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetFolderChildren(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetFolderChildrenSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsCreateSubfolder(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => CreateSubfolderSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUploadRecordsToKB(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UploadRecordsToKBSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUploadRecordsToFolder(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UploadRecordsToFolderSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetUploadLimits(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetUploadLimitsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsReindexRecord(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ReindexRecordSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsReindexRecordGroup(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ReindexRecordGroupSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsResyncConnector(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ResyncConnectorSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetConnectorStats(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetConnectorStatsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsListKBPermissions(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ListKBPermissionsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUpdateKBPermissions(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UpdateKBPermissionsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsCreateConversation(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => CreateConversationSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetAllConversations(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetAllConversationsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetArchivedConversations(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetArchivedConversationsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetConversationById(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetConversationByIdSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsDeleteConversationById(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => DeleteConversationByIdSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsShareConversation(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ShareConversationSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUpdateConversationTitle(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UpdateConversationTitleSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsArchiveConversation(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ArchiveConversationSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUnarchiveConversation(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UnarchiveConversationSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsRegenerateAnswer(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => RegenerateAnswerSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUpdateMessageFeedback(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UpdateMessageFeedbackSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsSearch(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => SearchSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsSearchHistory(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => SearchHistorySecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsDeleteAllSearchHistory(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => DeleteAllSearchHistorySecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsListAgentTemplates(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ListAgentTemplatesSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetAgentTemplate(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetAgentTemplateSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUpdateAgentTemplate(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UpdateAgentTemplateSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsDeleteAgentTemplate(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => DeleteAgentTemplateSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsListAgents(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ListAgentsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsCreateAgent(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => CreateAgentSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsListAgentTools(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ListAgentToolsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetAgent(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetAgentSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUpdateAgent(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UpdateAgentSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsDeleteAgent(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => DeleteAgentSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetAgentPermissions(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetAgentPermissionsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUpdateAgentPermissions(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UpdateAgentPermissionsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsShareAgent(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ShareAgentSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsListAgentConversations(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ListAgentConversationsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsCreateAgentConversation(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => CreateAgentConversationSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetAgentConversation(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetAgentConversationSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsDeleteAgentConversation(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => DeleteAgentConversationSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsAddAgentMessage(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => AddAgentMessageSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsRegenerateAgentAnswer(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => RegenerateAgentAnswerSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetConnectorRegistry(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetConnectorRegistrySecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetConnectorSchema(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetConnectorSchemaSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsListConnectorInstances(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ListConnectorInstancesSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsCreateConnectorInstance(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => CreateConnectorInstanceSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsListActiveConnectors(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ListActiveConnectorsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsListInactiveConnectors(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ListInactiveConnectorsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsListConfiguredConnectors(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ListConfiguredConnectorsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsListActiveAgentConnectors(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ListActiveAgentConnectorsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetConnectorInstance(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetConnectorInstanceSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsDeleteConnectorInstance(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => DeleteConnectorInstanceSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUpdateConnectorName(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UpdateConnectorNameSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetConnectorConfig(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetConnectorConfigSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUpdateConnectorConfig(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UpdateConnectorConfigSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUpdateConnectorAuthConfig(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UpdateConnectorAuthConfigSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUpdateConnectorFiltersSyncConfig(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UpdateConnectorFiltersSyncConfigSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsToggleConnector(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ToggleConnectorSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetOAuthAuthorizationUrl(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetOAuthAuthorizationUrlSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetConnectorFilters(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetConnectorFiltersSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetFilterFieldOptions(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetFilterFieldOptionsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetStorageConfig(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetStorageConfigSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsCreateSMTPConfig(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => CreateSMTPConfigSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetSMTPConfig(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetSMTPConfigSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsSetAzureAdAuthConfig(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => SetAzureAdAuthConfigSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetAzureAdAuthConfig(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetAzureAdAuthConfigSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsSetMicrosoftAuthConfig(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => SetMicrosoftAuthConfigSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetMicrosoftAuthConfig(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetMicrosoftAuthConfigSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsSetGoogleAuthConfig(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => SetGoogleAuthConfigSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetGoogleAuthConfig(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetGoogleAuthConfigSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsSetSsoAuthConfig(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => SetSsoAuthConfigSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetSsoAuthConfig(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetSsoAuthConfigSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsSetOAuthConfig(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => SetOAuthConfigSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetGenericOAuthConfig(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetGenericOAuthConfigSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetModelsByType(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetModelsByTypeSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetAvailableModelsByType(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetAvailableModelsByTypeSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsAddAIModelProvider(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => AddAIModelProviderSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsUpdateAIModelProvider(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => UpdateAIModelProviderSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsSetDefaultAIModel(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => SetDefaultAIModelSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsSetFrontendPublicUrl(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => SetFrontendPublicUrlSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetFrontendPublicUrl(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetFrontendPublicUrlSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsSetConnectorPublicUrl(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => SetConnectorPublicUrlSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetConnectorPublicUrl(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetConnectorPublicUrlSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsSetPlatformSettings(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => SetPlatformSettingsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetPlatformSettings(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetPlatformSettingsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetAvailableFeatureFlags(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetAvailableFeatureFlagsSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsSetCustomSystemPrompt(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => SetCustomSystemPromptSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetCustomSystemPrompt(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetCustomSystemPromptSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetMetricsCollection(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetMetricsCollectionSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsToggleMetricsCollection(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ToggleMetricsCollectionSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsScheduleCrawlingJob(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => ScheduleCrawlingJobSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsGetCrawlingJobStatus(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => GetCrawlingJobStatusSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private async getCredentialsRemoveCrawlingJob(
    security: unknown,
  ): Promise<Credentials | null> {
    const out = parse(
      security,
      (val) => RemoveCrawlingJobSecurity$zodSchema.parse(val),
      "unexpected security type",
    );

    const additionalProperties: Record<string, string> = {};
    for (const [key, value] of Object.entries(out?.oauth2 ?? {})) {
      if (
        typeof value === "string"
        && !["clientID", "clientSecret", "tokenURL", "scopes"].includes(key)
      ) {
        additionalProperties[key] = value;
      }
    }

    return {
      clientID: out?.oauth2?.clientID ?? "",
      clientSecret: out?.oauth2?.clientSecret ?? "",
      tokenURL: out?.oauth2?.tokenURL ?? "",
      scopes: undefined,
      additionalProperties,
    };
  }

  private getSessionKey(credentials: Credentials): string {
    const key = `${credentials.clientID}:${credentials.clientSecret}`;
    return stringToBase64(key);
  }

  private getRequiredScopes(
    credentials: Credentials,
    oAuth2Scopes: string[],
  ): string[] {
    if (credentials.scopes !== undefined) {
      return credentials.scopes;
    }
    return oAuth2Scopes;
  }
}
