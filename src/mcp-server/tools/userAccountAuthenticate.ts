/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import { userAccountAuthenticate } from "../../funcs/userAccountAuthenticate.js";
import { AuthenticateRequestRequest$zodSchema } from "../../models/authenticateop.js";
import { formatResult, ToolDefinition } from "../tools.js";

const args = {
  request: AuthenticateRequestRequest$zodSchema,
};

export const tool$userAccountAuthenticate: ToolDefinition<typeof args> = {
  name: "user-account-authenticate",
  description: `Authenticate user with credentials

Authenticate a user using the specified method and credentials.
Requires a valid session token from <code>/initAuth</code>.
<br><br>
<b>Credential Formats by Method:</b><br>
- <code>password</code>: <code>{ "credentials": { "password": "your-password" } }</code><br>
- <code>otp</code>: <code>{ "credentials": { "otp": "123456" } }</code> (6-digit code, valid for 10 minutes)<br>
- <code>google</code>: <code>{ "credentials": "google-id-token-string" }</code><br>
- <code>microsoft</code>: <code>{ "credentials": { "accessToken": "...", "idToken": "..." } }</code><br>
- <code>azureAd</code>: <code>{ "credentials": { "accessToken": "...", "idToken": "..." } }</code><br>
- <code>oauth</code>: <code>{ "credentials": { "accessToken": "...", "idToken": "..." } }</code><br>
- <code>samlSso</code>: Handled via redirect flow (use <code>/saml/signIn</code> instead)
<br><br>
<b>Multi-Step Response:</b><br>
If organization uses MFA, successful authentication returns:<br>
- <code>status: "success"</code> with <code>nextStep</code> and <code>allowedMethods</code> for next step
<br><br>
<b>Fully Authenticated Response:</b><br>
After completing all steps:<br>
- <code>message: "Fully authenticated"</code> with <code>accessToken</code> (1hr) and <code>refreshToken</code> (7d)
<br><br>
<b>Security:</b><br>
- Account locks after 5 consecutive failed attempts<br>
- CAPTCHA may be required if enabled (pass <code>cf-turnstile-response</code>)
`,
  annotations: {
    "title": "",
    "destructiveHint": false,
    "idempotentHint": false,
    "openWorldHint": false,
    "readOnlyHint": false,
  },
  args,
  tool: async (client, args, ctx) => {
    const [result] = await userAccountAuthenticate(
      client,
      args.request,
      { fetchOptions: { signal: ctx.signal } },
    ).$inspect();

    if (!result.ok) {
      return {
        content: [{ type: "text", text: result.error.message }],
        isError: true,
      };
    }

    return formatResult(result.value);
  },
};
